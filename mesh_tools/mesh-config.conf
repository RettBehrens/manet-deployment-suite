############################
# Mesh Network Configuration
############################

# IMPORTANT CONFIGURATION NOTES:
# - Don't worry about needing to change everything here. Only change what you need to.
# - The script will check to see what is present on the system before trying to use it, so it is ok if you leave some of these as their defaults.
# - If you mess anything up or if a required interface is not found, it will be logged in /var/log/mesh-network/mesh-network.log
# - For multi-node deployments, each node needs a UNIQUE IP address. See examples for nodes 1-4 below.
# - Most mesh parameters (MESH_ESSID, MESH_CHANNEL, MESH_CELL_ID, etc.) must be IDENTICAL across all nodes.

# INTERFACE NAME STABILITY:
# I highly recommend you match interface names to the hardware addresses so they don't change after a reboot.
# This prevents configuration issues when the system reassigns interface names (e.g., wlan0 becoming wlan1).
# 
# To create a stable interface name mapping, create a file like /etc/systemd/network/10-wlan0.link:
#   [Match]
#   MACAddress=xx:xx:xx:xx:xx:xx    # Replace with your actual WiFi adapter MAC address
#   [Link]
#   Name=wlan0                       # The name you want this interface to always have
#
# You can find MAC addresses with: ip link show
# After creating the file, reboot or run: sudo systemctl restart systemd-networkd
# Note: This might cause boot issues if you try to boot without the interface connected or if another tool manages interface names.

###############################################################################################################
# NODE-SPECIFIC CONFIGURATION - Configure these according to your network & hardware
# Refer to required fields in the README for more details
###############################################################################################################

# ============================================================================
# WIRELESS INTERFACE CONFIGURATION
# ============================================================================

# MESH_IFACE: Primary wireless interface used for mesh connections between nodes
# This is the interface that will participate in the batman-adv mesh network.
# Requirements:
#   - Must support ad-hoc (IBSS) mode (check with: iw list | grep -A 5 "IBSS")
#   - Should be the same physical interface type across all nodes for best compatibility
#   - Find available interfaces with: iwconfig or ip link show
#   - This interface will be configured with an ad-hoc network and batman-adv will run on top of it
MESH_IFACE=wlan0

# WAP_IFACE: Wireless Access Point interface for client devices (optional)
# This allows regular WiFi clients (laptops, phones, etc.) to connect to the mesh network.
# If you don't have a second WiFi adapter, leave this commented out or the script will skip it.
# Requirements:
#   - Should be a different physical interface from MESH_IFACE (if both are used)
#   - Must support AP (Access Point) mode
#   - Find available interfaces with: iwconfig or ip link show
WAP_IFACE=wlan1

# WAP_SSID: Network name (SSID) broadcast by the access point
# This is what client devices will see when scanning for WiFi networks.
# Tips:
#   - Can be the same across all nodes (clients will connect to the strongest signal)
#   - Or unique per node for easier identification (e.g., MeshAccess01, MeshAccess02, etc.)
#   - Keep it simple - avoid special characters that might cause issues
WAP_SSID=MeshAccess01

# WAP_PASSWORD: WiFi password for client devices connecting to the access point
# Security note: This only protects the access point connection, NOT the mesh network itself.
# The mesh network (MESH_IFACE) is currently unencrypted - see README security section.
# Requirements:
#   - Minimum 8 characters (WPA2 requirement)
#   - Should be strong if handling sensitive data
WAP_PASSWORD=meshpassword

# WAP_CHANNEL: WiFi channel for the access point
# Must be different from MESH_CHANNEL to avoid interference.
# Valid ranges:
#   - 2.4GHz (g mode): Channels 1-13 (varies by region)
#   - 5GHz (a mode): Channels 36-165 (varies by region and regulatory domain)
# Tips:
#   - Use non-overlapping channels: 1, 6, 11 for 2.4GHz
#   - Keep at least 5 channels apart from MESH_CHANNEL
#   - Check local regulations for allowed channels in your region
WAP_CHANNEL=6

# WAP_HW_MODE: Hardware mode for the access point
# Options:
#   - "g" = 2.4GHz (IEEE 802.11g) - More range, more interference, slower speeds
#   - "a" = 5GHz (IEEE 802.11a) - Less range, less interference, faster speeds
# Note: Must match the capabilities of your WAP_IFACE hardware
WAP_HW_MODE=g

# ============================================================================
# ETHERNET INTERFACE CONFIGURATION (optional)
# ============================================================================

# ETH_WAN: Ethernet interface for WAN (Internet) connection (optional)
# If this node will act as a gateway to the internet, specify the interface connected to your modem/router.
# Leave commented or empty if this node is not a gateway.
# Find available interfaces with: ip link show
ETH_WAN=eth0

# ETH_LAN: Ethernet interface for LAN connection (optional)
# Used for connecting to other devices via Ethernet cable.
# Useful for wired clients or connecting to other network equipment.
# Leave commented or empty if not needed.
ETH_LAN=eth1

# ============================================================================
# IP ADDRESS CONFIGURATION - CRITICAL: Each node must have UNIQUE IP addresses
# ============================================================================

# NODE_IP: This node's IP address on the mesh network
# THIS IS THE MOST IMPORTANT SETTING - each node must have a different IP address!
# Requirements:
#   - Must be unique across all nodes in the mesh
#   - Must be within the subnet defined by MESH_NETMASK
#   - Should follow a sequential pattern for easy management (e.g., 10.0.0.1, 10.0.0.2, 10.0.0.3, etc.)
#   - This IP will be assigned to the bat0 interface created by batman-adv
# Tips:
#   - Reserve .1 for your primary gateway node if you have one
#   - Use sequential numbering for easy identification
#   - Create /etc/bat-hosts file with hostname mappings (e.g., "1 10.0.0.1") for easy reference
NODE_IP=10.0.0.1

# WAP_IP: IP address for the wireless access point interface (optional)
# Only needed if WAP_IFACE is configured. Each node with an access point should have a unique WAP_IP.
# This IP is on a separate subnet from the mesh network to avoid conflicts.
# Requirements:
#   - Must be unique if multiple nodes have access points
#   - Should be on a different subnet from NODE_IP (e.g., 10.10.0.x vs 10.0.0.x)
#   - Must be within the subnet defined by MESH_NETMASK (or use a separate netmask if needed)
WAP_IP=10.10.0.1

# ETH_LAN_IP: IP address for the Ethernet LAN interface (optional)
# Only needed if ETH_LAN is configured. Each node with Ethernet LAN should have a unique ETH_LAN_IP.
# Requirements:
#   - Must be unique if multiple nodes have Ethernet LAN interfaces
#   - Can be on the same subnet as WAP_IP or a different subnet
#   - Must be within the subnet defined by MESH_NETMASK
ETH_LAN_IP=10.10.0.2

# MESH_NETMASK: Network mask for the mesh network (CIDR notation)
# Common values: 24 (/24 = 255.255.255.0 = 254 usable IPs), 16 (/16 = 255.255.0.0 = 65,534 usable IPs)
# All nodes must use the same netmask.
# Tips:
#   - /24 is sufficient for most deployments (up to 254 nodes: 10.0.0.1 - 10.0.0.254)
#   - /16 allows for much larger networks but uses more broadcast traffic
#   - Remember: for /24, you can only change the last octet (10.0.0.x)
#   - For /16, you can change the last two octets (10.0.x.x)
MESH_NETMASK=24

# DNS_SERVERS: Comma-separated list of DNS servers to use
# These are used for DNS resolution on the mesh network.
# Options:
#   - Public DNS: 9.9.9.9 (Quad9), 8.8.8.8 (Google), 1.1.1.1 (Cloudflare)
#   - Your gateway's DNS (if it provides DNS services)
#   - Multiple servers provide redundancy (first is primary, others are fallbacks)
# Tips:
#   - Use at least 2-3 DNS servers for redundancy
#   - If you have a gateway node, you might want to use its IP as a DNS server
DNS_SERVERS=9.9.9.9,8.8.8.8

###################################################################################
# MESH NETWORK PARAMETERS - Must be CONSISTENT across ALL nodes
# Only change these if you understand the implications
###################################################################################

# ============================================================================
# MESH NETWORK CORE PARAMETERS
# ============================================================================

# MESH_MTU: Maximum Transmission Unit for the mesh interface
# This is the maximum size of a packet that can be transmitted without fragmentation.
# Default: 1500 bytes (standard Ethernet MTU)
# Considerations:
#   - Lower values = more overhead but better for unreliable links
#   - Higher values = more efficient but may fragment on some links
#   - 1500 is standard and works well for most deployments
#   - If you experience packet loss, try reducing to 1400 or 1280
MESH_MTU=1500

# MESH_MODE: Wireless mode for the mesh interface
# MUST be set to "ad-hoc" for batman-adv mesh networks.
# Do not change this unless you're using a different mesh protocol.
MESH_MODE=ad-hoc

# MESH_ESSID: Extended Service Set Identifier (network name) for the mesh
# This is the network name that identifies your mesh network.
# ALL NODES MUST USE THE SAME MESH_ESSID to join the same mesh.
# Requirements:
#   - Must be identical across all nodes
#   - Can be up to 32 characters
#   - Avoid special characters
#   - This is what identifies nodes as part of the same mesh network
MESH_ESSID=mesh-network

# MESH_CHANNEL: WiFi channel for the mesh network
# ALL NODES MUST USE THE SAME CHANNEL to communicate.
# Valid ranges (varies by region and hardware):
#   - 2.4GHz: Channels 1-13 (most common: 1, 6, 11 are non-overlapping)
#   - 5GHz: Channels 36-165 (varies by regulatory domain)
# Requirements:
#   - Must be identical across all nodes
#   - Must be different from WAP_CHANNEL (if using access point)
#   - Must be legal in your region (check with: iw list)
# Tips:
#   - Channels 1, 6, 11 don't overlap in 2.4GHz - good for avoiding interference
#   - 5GHz has less interference but shorter range
#   - Use: iw list to see supported channels for your hardware
MESH_CHANNEL=1

# MESH_CELL_ID: Cell ID (BSSID) for the ad-hoc network
# This is the MAC address used as the network identifier for the ad-hoc mesh.
# ALL NODES MUST USE THE SAME MESH_CELL_ID.
# Format: MAC address in format XX:XX:XX:XX:XX:XX
# Requirements:
#   - Must be identical across all nodes
#   - Should start with 02 (locally administered address)
#   - Must be a valid MAC address format
# Tips:
#   - Generate a unique one for your network (but use the same one on all nodes)
#   - Can use: openssl rand -hex 3 | sed 's/\(..\)/02:\1/g' to generate one
MESH_CELL_ID=02:12:34:56:78:9A

# ============================================================================
# BATMAN-ADV PARAMETERS - Advanced routing protocol settings
# ============================================================================

# BATMAN_ORIG_INTERVAL: Originator interval in milliseconds
# This controls how often batman-adv sends out "hello" messages to discover and maintain routes.
# Lower values = faster route updates but more overhead
# Higher values = less overhead but slower to detect route changes
# Default: 1000ms (1 second)
# Considerations:
#   - 500-2000ms is typical range
#   - Lower for mobile/fast-changing networks
#   - Higher for stable/static networks
#   - All nodes should use the same value
BATMAN_ORIG_INTERVAL=1000

# BATMAN_HOP_PENALTY: Penalty added for each hop in the path
# This makes batman-adv prefer shorter paths (fewer hops).
# Higher values = stronger preference for direct connections
# Lower values = more tolerance for multi-hop paths
# Default: 30
# Considerations:
#   - Typical range: 0-50
#   - Higher penalty = more stable routes but less flexibility
#   - Lower penalty = more flexible routing but potentially less stable
#   - All nodes should use the same value
BATMAN_HOP_PENALTY=30

# BATMAN_ROUTING_ALGORITHM: Routing algorithm to use
# Options:
#   - BATMAN_IV: Original algorithm, more stable, widely supported
#   - BATMAN_V: Newer algorithm, better performance, requires newer batctl
# Requirements:
#   - Must be identical across all nodes
#   - Check batctl version: batctl -v (BATMAN_V requires batctl 2019.0+)
# Tips:
#   - BATMAN_V is recommended for new deployments if all nodes support it
#   - BATMAN_IV is safer for mixed-version deployments
#   - Check compatibility: batctl -m | grep "Routing algorithm"
BATMAN_ROUTING_ALGORITHM=BATMAN_V

###################################################################################
# EXAMPLE CONFIGURATIONS FOR NODES 1-4
###################################################################################
#
# The examples below assume EVERY node:
#   - Runs an access point on `WAP_IFACE`
#   - Has WAN connectivity on `ETH_WAN`
#   - Bridges local Ethernet clients on `ETH_LAN`
#   - Shares the mesh parameters defined above (MESH_*, BATMAN_*)
# Copy the block matching your node number and adjust only the values that must be unique.
#
# =========================================================================
# NODE 1 CONFIGURATION (Example)
# =========================================================================
# MESH_IFACE=wlan0
# WAP_IFACE=wlan1
# WAP_SSID=MeshAccess01
# WAP_PASSWORD=meshpassword
# WAP_CHANNEL=6
# WAP_HW_MODE=g
# ETH_WAN=eth0
# ETH_LAN=eth1
# NODE_IP=10.0.0.1
# WAP_IP=10.10.0.1
# ETH_LAN_IP=10.10.0.2
# MESH_NETMASK=24
# DNS_SERVERS=9.9.9.9,8.8.8.8
# MESH_MTU=1500
# MESH_MODE=ad-hoc
# MESH_ESSID=mesh-network
# MESH_CHANNEL=1
# MESH_CELL_ID=02:12:34:56:78:9A
# BATMAN_ORIG_INTERVAL=1000
# BATMAN_HOP_PENALTY=30
# BATMAN_ROUTING_ALGORITHM=BATMAN_V
#
# =========================================================================
# NODE 2 CONFIGURATION (Example)
# =========================================================================
# MESH_IFACE=wlan0
# WAP_IFACE=wlan1
# WAP_SSID=MeshAccess02
# WAP_PASSWORD=meshpassword
# WAP_CHANNEL=6
# WAP_HW_MODE=g
# ETH_WAN=eth0
# ETH_LAN=eth1
# NODE_IP=10.0.0.2
# WAP_IP=10.10.0.3
# ETH_LAN_IP=10.10.0.4
# MESH_NETMASK=24
# DNS_SERVERS=9.9.9.9,8.8.8.8
# MESH_MTU=1500
# MESH_MODE=ad-hoc
# MESH_ESSID=mesh-network
# MESH_CHANNEL=1
# MESH_CELL_ID=02:12:34:56:78:9A
# BATMAN_ORIG_INTERVAL=1000
# BATMAN_HOP_PENALTY=30
# BATMAN_ROUTING_ALGORITHM=BATMAN_V
#
# =========================================================================
# NODE 3 CONFIGURATION (Example)
# =========================================================================
# MESH_IFACE=wlan0
# WAP_IFACE=wlan1
# WAP_SSID=MeshAccess03
# WAP_PASSWORD=meshpassword
# WAP_CHANNEL=6
# WAP_HW_MODE=g
# ETH_WAN=eth0
# ETH_LAN=eth1
# NODE_IP=10.0.0.3
# WAP_IP=10.10.0.5
# ETH_LAN_IP=10.10.0.6
# MESH_NETMASK=24
# DNS_SERVERS=9.9.9.9,8.8.8.8
# MESH_MTU=1500
# MESH_MODE=ad-hoc
# MESH_ESSID=mesh-network
# MESH_CHANNEL=1
# MESH_CELL_ID=02:12:34:56:78:9A
# BATMAN_ORIG_INTERVAL=1000
# BATMAN_HOP_PENALTY=30
# BATMAN_ROUTING_ALGORITHM=BATMAN_V
#
# =========================================================================
# NODE 4 CONFIGURATION (Example)
# =========================================================================
# MESH_IFACE=wlan0
# WAP_IFACE=wlan1
# WAP_SSID=MeshAccess04
# WAP_PASSWORD=meshpassword
# WAP_CHANNEL=6
# WAP_HW_MODE=g
# ETH_WAN=eth0
# ETH_LAN=eth1
# NODE_IP=10.0.0.4
# WAP_IP=10.10.0.7
# ETH_LAN_IP=10.10.0.8
# MESH_NETMASK=24
# DNS_SERVERS=9.9.9.9,8.8.8.8
# MESH_MTU=1500
# MESH_MODE=ad-hoc
# MESH_ESSID=mesh-network
# MESH_CHANNEL=1
# MESH_CELL_ID=02:12:34:56:78:9A
# BATMAN_ORIG_INTERVAL=1000
# BATMAN_HOP_PENALTY=30
# BATMAN_ROUTING_ALGORITHM=BATMAN_V
#
# =========================================================================
# WHAT MUST STAY UNIQUE PER NODE?
# =========================================================================
# - NODE_IP (e.g., 10.0.0.1, 10.0.0.2, 10.0.0.3, 10.0.0.4)
# - WAP_IP (e.g., 10.10.0.1, 10.10.0.3, 10.10.0.5, 10.10.0.7)
# - ETH_LAN_IP (e.g., 10.10.0.2, 10.10.0.4, 10.10.0.6, 10.10.0.8)
# - WAP_SSID (optional, but unique names can help identify nodes)
#
# EVERYTHING ELSE SHOULD MATCH ACROSS ALL NODES:
# - MESH_* values (except NODE_IP)
# - BATMAN_* values
# - Interface names (assuming consistent hardware)
# - DNS servers (unless you have node-specific resolvers)
# - WAP_PASSWORD, WAP_CHANNEL, WAP_HW_MODE (keep identical for roaming clients)
#
###################################################################################
